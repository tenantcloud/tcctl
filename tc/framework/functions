#!/usr/bin/env bash

__draw_line() {
  __count=$2
  __symbol_count=${__count:=80}
  echo $( for i in $(seq 1 1 $__symbol_count) ; do printf "$1"; done )
}

__show_date_hostname() {
  echo "[$(date '+%Y-%m-%d %H:%M:%S')] on $(hostname)"
}

function _message_info() {
  echo "= INFO ========================================================================="
  __show_date_hostname
  __draw_line -
  printf "$1\n"
  __draw_line -
}

function _message_warning() {
  __exit_code_number=$?
  [[ $__exit_code_number -eq "0" ]] && __exit_code_number=$_error_code
  unset _error_code
  echo "= WARNING ======================================================================"
  __show_date_hostname
  __draw_line -
  echo "Exit code $__exit_code_number"
  printf "$1\n"
  __draw_line -
}

function _message_error() {
  __exit_code_number=$?
  [[ $__exit_code_number -eq "0" ]] && __exit_code_number=$_error_code
  unset _error_code
  echo "= ERROR ========================================================================"
  __show_date_hostname
  __draw_line -
  echo "Exit code $__exit_code_number"
  printf "$1\n"
  __draw_line -
  exit $__exit_code_number
}

# Function show message (info, error, warning)
# Usage: _message "message" "error" "128"
#        _message "message"
function _message {
  __message_body="$1"
  [[ -z $2 ]] && __message_type="info" || __message_type="$2"
  [[ -z $3 ]] && __message_error_code="0" || __message_error_code="$3"

  case "$__message_type" in
    error)
      echo "= ERROR ========================================================================"
    ;;
    warning)
      echo "= WARNING ======================================================================"
    ;;
    *)
      echo "= INFO ========================================================================="
    ;;
  esac

  __show_date_hostname
  __draw_line -

  [[ $__message_type != "info" ]] && echo "Exit code $__message_error_code"
  printf "%s\n" "$__message_body"
  
  __draw_line -

  [[ $__message_type == "error" ]] && exit "$__message_error_code"
}

function _get_project_path() {
  pwd
}

function _get_project_name() {
  __path="${PWD##*/}"
  echo "${__path//./-}"
}

function _get_os() {
  OS=$(uname -s)
  echo "$OS"
}
