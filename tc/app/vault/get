#!/usr/bin/env bash

VAULT_CONFIG_FILE=~/.vault-configuration

function vault_get() {
  source $VAULT_CONFIG_FILE
  tcctl vault token
  VAULT_SECRETS=$1
  ENV_FILE=$2
  MSG="Get from vault"
  vault kv get $VAULT_SECRETS | sed 's/\ \{1,\}/=/g' | sed 1,11d > /tmp/.env.vault
  tcctl vault diff .env \
    && tcctl vault message "Success. $MSG" \
    || tcctl vault messageError "Error. $MSG"
}

vault_get $1 $2
